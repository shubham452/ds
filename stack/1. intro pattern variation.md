Perfect.
Below is a **complete, interview-grade STACK guide**, exactly in the format you asked:

* âœ… **Types of questions**
* âœ… **Patterns**
* âœ… **Variations**
* âœ… **Templates (canonical)**
* âœ… **Tricks & pitfalls**
* âœ… **15 top stack questions (company-wise, ranked)**

This is **how interviewers actually think about stacks**.

---

# ğŸ§  STACK â€” INTERVIEW MASTER GUIDE

## ğŸ”‘ What a Stack is REALLY used for

> **Managing â€œlast seenâ€ or â€œpendingâ€ elements where future input resolves past work**

If a problem says:

* *next*, *previous*
* *nearest*
* *undo*
* *balanced*
* *nested*
* *monotonic*

ğŸ‘‰ **Think STACK immediately**

---

# ğŸ§© STACK QUESTION TYPES & PATTERNS

---

## ğŸŸ© TYPE 1: **Monotonic Stack (Next / Previous Greater or Smaller)**

### ğŸ“Œ Question type

* Next Greater Element
* Previous Smaller Element
* Nearest Greater to Left / Right

### ğŸ§  Pattern

Maintain stack in **increasing or decreasing order**

### âœ… Template (Next Greater Right)

```cpp
stack<int> st;
vector<int> ans(n, -1);

for (int i = n - 1; i >= 0; i--) {
    while (!st.empty() && st.top() <= nums[i])
        st.pop();

    ans[i] = st.empty() ? -1 : st.top();
    st.push(nums[i]);
}
```

### ğŸ” Variations

* Left â†’ traverse left to right
* Smaller â†’ flip comparison
* Circular â†’ loop twice

### âš ï¸ Pitfalls

* Wrong traversal direction
* Forgetting circular logic
* Using values vs indices incorrectly

---

## ğŸŸ© TYPE 2: **Monotonic Stack for Range Contribution**

### ğŸ“Œ Question type

* Sum of Subarray Minimums
* Largest Rectangle in Histogram

### ğŸ§  Pattern

Each element contributes as **min/max** for a range

### âœ… Template (Histogram)

```cpp
stack<int> st;
for (int i = 0; i <= n; i++) {
    int h = (i == n ? 0 : heights[i]);
    while (!st.empty() && h < heights[st.top()]) {
        int height = heights[st.top()];
        st.pop();
        int width = st.empty() ? i : i - st.top() - 1;
        ans = max(ans, height * width);
    }
    st.push(i);
}
```

### âš ï¸ Pitfalls

* Forgetting sentinel `0`
* Miscalculating width
* Off-by-one errors

---

## ğŸŸ© TYPE 3: **Balanced Parentheses / Expression Validation**

### ğŸ“Œ Question type

* Valid Parentheses
* Minimum Remove to Make Valid

### ğŸ§  Pattern

Push opening, pop on closing

### âœ… Template

```cpp
stack<char> st;
for (char c : s) {
    if (c == '(') st.push(c);
    else {
        if (st.empty()) return false;
        st.pop();
    }
}
return st.empty();
```

### âš ï¸ Pitfalls

* Forgetting final empty check
* Ignoring multiple bracket types

---

## ğŸŸ© TYPE 4: **Expression Evaluation (Infix / Postfix / Prefix)**

### ğŸ“Œ Question type

* Evaluate Reverse Polish Notation
* Basic Calculator

### ğŸ§  Pattern

Operands â†’ stack
Operators â†’ apply and push result

### âœ… Template (Postfix)

```cpp
stack<int> st;
for (string t : tokens) {
    if (isOperator(t)) {
        int b = st.top(); st.pop();
        int a = st.top(); st.pop();
        st.push(apply(a, b, t));
    } else {
        st.push(stoi(t));
    }
}
return st.top();
```

### âš ï¸ Pitfalls

* Operand order (a vs b)
* Integer division rules

---

## ğŸŸ© TYPE 5: **Stack Simulation (Undo / Backtracking)**

### ğŸ“Œ Question type

* Baseball Game
* Remove Adjacent Duplicates

### ğŸ§  Pattern

Simulate actions using stack

### âœ… Template

```cpp
stack<int> st;
for (op : ops) {
    if (op == "+") {
        int a = st.top(); st.pop();
        int b = st.top();
        st.push(a);
        st.push(a + b);
    }
    else if (op == "D") st.push(2 * st.top());
    else if (op == "C") st.pop();
    else st.push(stoi(op));
}
```

---

## ğŸŸ© TYPE 6: **Monotonic Stack + Indices (Temperature / Stock Span)**

### ğŸ“Œ Question type

* Daily Temperatures
* Online Stock Span

### ğŸ§  Pattern

Store indices to compute distance

### âœ… Template

```cpp
stack<int> st;
for (int i = 0; i < n; i++) {
    while (!st.empty() && nums[i] > nums[st.top()]) {
        int idx = st.top(); st.pop();
        ans[idx] = i - idx;
    }
    st.push(i);
}
```

---

## ğŸŸ© TYPE 7: **Stack + String Processing**

### ğŸ“Œ Question type

* Decode String
* Remove Duplicate Letters

### ğŸ§  Pattern

Stack to manage nested or lexicographic constraints

### âœ… Template (Decode)

```cpp
stack<int> count;
stack<string> result;
string curr;
int k = 0;

for (char c : s) {
    if (isdigit(c)) k = k * 10 + (c - '0');
    else if (c == '[') {
        count.push(k);
        result.push(curr);
        curr = "";
        k = 0;
    }
    else if (c == ']') {
        string temp = curr;
        curr = result.top(); result.pop();
        int times = count.top(); count.pop();
        while (times--) curr += temp;
    }
    else curr += c;
}
```

---

# ğŸš¨ TOP STACK TRICKS & PITFALLS

### ğŸ”¥ Must-know traps

1. Using stack when **deque** is better (sliding window)
2. Forgetting **indices** when distances are needed
3. Wrong comparison (`<` vs `<=`)
4. Missing sentinel values
5. Stack not emptied at end
6. Mixing value stack vs index stack
7. Incorrect circular traversal
8. Ignoring duplicates handling
9. Overflow in area problems
10. Overusing recursion instead of stack

---

# ğŸ¢ 15 TOP STACK QUESTIONS (COMPANY-WISE, RANKED)

### ğŸŸ¢ GOOGLE

1. Largest Rectangle in Histogram
2. Sum of Subarray Minimums
3. Daily Temperatures
4. Decode String
5. Basic Calculator II

---

### ğŸŸ£ META (Facebook)

6. Valid Parentheses
7. Next Greater Element I
8. Remove Duplicate Letters
9. Evaluate Reverse Polish Notation

---

### ğŸŸ  AMAZON

10. Online Stock Span
11. Asteroid Collision
12. Baseball Game

---

### ğŸ APPLE

13. Next Greater Element II
14. Remove All Adjacent Duplicates in String II

---

### ğŸŸ¡ MICROSOFT

15. Trapping Rain Water *(stack approach)*

---

# ğŸ§  INTERVIEW POWER LINE (STACK)

Use this confidently:

> â€œA stack lets me defer processing until I see a resolving element.â€

Interviewers **love this line**.

---

## ğŸš€ WHAT NEXT?

If you want:

* âœ… **Stack vs Two Pointer vs Sliding Window decision guide**
* âœ… **Top 10 hardest stack problems explained**
* âœ… **Company-wise mock interview (stack-heavy)**

Just say the word ğŸ”¥
